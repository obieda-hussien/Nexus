# ุญู ูุดููุฉ ุญูุธ ุจูุงูุงุช ุงููุณุชุฎุฏู ูู Firebase Firestore

## ุงููุดููุฉ ๐จ
ุนูุฏ ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏุ ูุชู ุชุณุฌูู ุงููุณุชุฎุฏู ุจูุฌุงุญ ูู Firebase Authentication ููู ูุง ูุชู ุญูุธ ุจูุงูุงุช ุงูููู ุงูุดุฎุตู ูู **Cloud Firestore**ุ ููุง ูุคุฏู ุฅูู ุธููุฑ ุดุงุดุฉ ุงูุชุญููู ุฅูู ูุง ูุง ููุงูุฉ ูู ููุญุฉ ุงูุชุญูู.

## ููุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ ๐
ูุฐุง ุงููุดุฑูุน ูุณุชุฎุฏู **Cloud Firestore** (ูููุณ Realtime Database) ูุน ุงูุฎุทุฉ ุงููุฌุงููุฉ.

## ุงูุฃุณุจุงุจ ุงููุญุชููุฉ โ

### 1. ุงูุชูุงุก ุตูุงุญูุฉ ูุถุน ุงูุงุฎุชุจุงุฑ (Test Mode)
ุฅุฐุง ููุช ุฃูุดุฃุช Firestore ูู "ูุถุน ุงูุงุฎุชุจุงุฑ"ุ ูุฅู ุงูุตูุงุญูุฉ ุชูุชูู ุจุนุฏ 30 ูููุงู.

### 2. ููุงุนุฏ ุงูุฃูุงู ุงููููุฏุฉ
ููุงุนุฏ ุงูุฃูุงู ุงูุงูุชุฑุงุถูุฉ ุชููุน ุนูููุงุช ุงููุฑุงุกุฉ ูุงููุชุงุจุฉ.

## ุงูุญู ุงูุชูุตููู ๐ง

### ุงูุฎุทูุฉ 1: ุงููุตูู ูููุงุนุฏ Firestore

1. ุงูุชูู ุฅูู [Firebase Console](https://console.firebase.google.com/)
2. ุงุฎุชุฑ ูุดุฑูุน `nexus-012`
3. ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉุ ุงุฎุชุฑ **Firestore Database**
4. ุงุจุญุซ ุนู ุชุจููุจ **Rules** ูู ุงูุฃุนูู (ุจุฌุงูุจ Data, Indexes, Usage)

> **ุฅุฐุง ูู ุชุฌุฏ ุชุจููุจ Rules**: ุงูุชูู ูู Cloud Firestore โ Database โ Rules

### ุงูุฎุทูุฉ 2: ุฅุนุฏุงุฏ ููุงุนุฏ ุงูุฃูุงู ููุฎุทุฉ ุงููุฌุงููุฉ

ูู ูุญุฑุฑ ุงูููุงุนุฏุ ุงุณุชุจุฏู ุงููุญุชูู ุงูุญุงูู ุจุงูููุงุนุฏ ุงูุชุงููุฉ:

```javascript
// ููุงุนุฏ Cloud Firestore ููุฎุทุฉ ุงููุฌุงููุฉ - Nexus Educational Platform
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // ููุงุนุฏ ุงููุณุชุฎุฏููู: ูู ูุณุชุฎุฏู ููููู ูุฑุงุกุฉ ููุชุงุจุฉ ุจูุงูุงุชู ููุท
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // ููุงุนุฏ ุงูููุฑุณุงุช: ูุฑุงุกุฉ ููุฌููุนุ ูุชุงุจุฉ ูููุณุฌููู ููุท
    match /courses/{courseId} {
      allow read: if true; // ูุฑุงุกุฉ ุนุงูุฉ ููููุฑุณุงุช
      allow write: if request.auth != null; // ูุชุงุจุฉ ูููุณุฌููู ููุท
    }
    
    // ููุงุนุฏ ุงูุฏุฑูุณ: ููุณ ููุงุนุฏ ุงูููุฑุณุงุช
    match /lessons/{lessonId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    // ููุงุนุฏ ุชูุฏู ุงููุณุชุฎุฏููู: ุฎุงุต ุจูู ูุณุชุฎุฏู
    match /user_progress/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // ููุงุนุฏ ุฅุญุตุงุฆูุงุช ุงูุงุณุชุฎุฏุงู: ูููุณุฌููู ููุท
    match /analytics_events/{eventId} {
      allow read, write: if request.auth != null;
    }
    
    // ููุงุนุฏ ุณุฌูุงุช ุงูุฃูุงู: ูููุณุฌููู ููุท
    match /security_logs/{logId} {
      allow read, write: if request.auth != null;
    }
    
    // ูุงุนุฏุฉ ุงุฎุชุจุงุฑ ุงูุงุชุตุงู (ูููุฉ ููุชุดุฎูุต)
    match /test/{testId} {
      allow read, write: if true;
    }
  }
}
```

### ุงูุฎุทูุฉ 3: ุญูุธ ุงูููุงุนุฏ
1. ุงุถุบุท ุนูู **Publish** ูุญูุธ ุงูููุงุนุฏ ุงูุฌุฏูุฏุฉ
2. ุณุชุธูุฑ ุฑุณุงูุฉ ุชุฃููุฏ ุจูุฌุงุญ ุงููุดุฑ

### 3. ุฅุถุงูุฉ ุฃุฏุงุฉ ุงูุชุดุฎูุต ุงููุชูุฏูุฉ ๐ง

ุชู ุฅุถุงูุฉ ุฃุฏุงุฉ ุชุดุฎูุต Firebase ูุชูุฏูุฉ ูููุณุงุนุฏุฉ ูู ุชุญุฏูุฏ ูุญู ุงููุดุงูู:

#### ุงููุตูู ูุฃุฏุงุฉ ุงูุชุดุฎูุต:
1. ูู ุดุฑูุท ุงูุชูููุ ุงุจุญุซ ุนู ุฃููููุฉ ุงูุฅุนุฏุงุฏุงุช (โ๏ธ) ุจุงูููู ุงูุจุฑุชูุงูู
2. ุงุถุบุท ุนูููุง ููุชุญ ุฃุฏุงุฉ ุงูุชุดุฎูุต ุงูุดุงููุฉ
3. ุณุชููู ุงูุฃุฏุงุฉ ุจูุญุต:
   - ุญุงูุฉ ุชููุฆุฉ Firebase
   - ุญุงูุฉ ุงููุตุงุฏูุฉ
   - ุงุชุตุงู Firestore
   - ูุฌูุฏ ููู ุงููุณุชุฎุฏู
   - ุตูุงุญูุงุช ุงููุฑุงุกุฉ ูุงููุชุงุจุฉ

#### ููุฒุงุช ุฃุฏุงุฉ ุงูุชุดุฎูุต:
- **ูุญุต ุดุงูู ุชููุงุฆู** ุนูุฏ ูุชุญ ุงูุฃุฏุงุฉ
- **ูุชุงุฆุฌ ููุตูุฉ** ูุน ุดุฑุญ ูู ูุดููุฉ
- **ุฑูุงุจุท ูุจุงุดุฑุฉ** ุฅูู Firebase Console
- **ุญููู ููุชุฑุญุฉ** ููู ูุดููุฉ ููุชุดูุฉ
- **ุฅุนุงุฏุฉ ูุญุต ููุฑู** ุจุถุบุทุฉ ุฒุฑ

## ุทุฑู ูุชุนุฏุฏุฉ ูุญู ุงููุดููุฉ ๐๏ธ

### ุงูุทุฑููุฉ ุงูุฃููู: ุฅุนุฏุงุฏ ููุงุนุฏ Firestore (ุงูุฃูุซุฑ ูุนุงููุฉ)
ุงุชุจุน ุงูุชุนูููุงุช ูู ููู `FIRESTORE_SETUP_GUIDE.md` ูุฅุนุฏุงุฏ ููุงุนุฏ ุงูุฃูุงู ุงูุตุญูุญุฉ.

### ุงูุทุฑููุฉ ุงูุซุงููุฉ: ุงุณุชุฎุฏุงู ุฃุฏุงุฉ ุงูุชุดุฎูุต
1. ุงุถุบุท ุนูู ุฃููููุฉ ุงูุฅุนุฏุงุฏุงุช ูู ุดุฑูุท ุงูุชููู
2. ุฑุงุฌุน ูุชุงุฆุฌ ุงููุญุต ุงูุชูุตูููุฉ  
3. ุงุชุจุน ุงูุญููู ุงูููุชุฑุญุฉ ููู ูุดููุฉ
4. ุงุณุชุฎุฏู ุงูุฑูุงุจุท ุงููุจุงุดุฑุฉ ูููุตูู ุฅูู Firebase Console

### ุงูุทุฑููุฉ ุงูุซุงูุซุฉ: ุฅูุดุงุก ุงูููู ุงูุดุฎุตู ูุฏููุงู
ุฅุฐุง ูุดูุช ุงูุทุฑู ุงูุณุงุจูุฉ:
1. ุณุฌู ุฏุฎูู ุจุงูุญุณุงุจ
2. ุงูุชุธุฑ ุธููุฑ ุฑุณุงูุฉ ุงูุฎุทุฃ ูู ููุญุฉ ุงูุชุญูู
3. ุงุถุบุท ุนูู ุฒุฑ "ุฅูุดุงุก ููู ุดุฎุตู"
4. ุณุชุชู ุฅุถุงูุฉ ุงูุจูุงูุงุช ุงูููููุฏุฉ ุชููุงุฆูุงู

## ุงูุชุดุฎูุต ูุงูุงุณุชูุดุงู ๐

### ูุญุต ุงูุงุชุตุงู ุจู Firestore
ุงูุชุญ ูุญุฏุฉ ุงูุชุญูู ูู ุงููุชุตูุญ (F12) ูุชุญูู ูู ุงูุฑุณุงุฆู:
- โ `Firestore connection successful` = ุงูุงุชุตุงู ูุนูู
- โ `Firestore connection failed` = ูุดููุฉ ูู ุงูุฅุนุฏุงุฏ

### ุฑุณุงุฆู ุงูุฎุทุฃ ุงูุดุงุฆุนุฉ:
- **"Permission denied"** โ ุชุญุฏูุซ ููุงุนุฏ ุงูุฃูุงู
- **"Missing or insufficient permissions"** โ ุงููุณุชุฎุฏู ุบูุฑ ูุณุฌู
- **"Document not found"** โ ูู ูุชู ุฅูุดุงุก ุงูููู ุงูุดุฎุตู

### ุงูุชุญูู ูู ุงูุจูุงูุงุช:
1. ูู Firebase Console โ Firestore Database โ Data
2. ุงุจุญุซ ุนู ูุฌููุนุฉ `users`
3. ูุฌุจ ุฃู ุชุฌุฏ ูุณุชูุฏ ุจู UID ุงููุณุชุฎุฏู

## ููุงุนุฏ ุฃูุงู ูุชูุฏูุฉ (ููุฅูุชุงุฌ) ๐

ุนูุฏ ูุดุฑ ุงููุดุฑูุน ุฑุณููุงูุ ุงุณุชุฎุฏู ููุงุนุฏ ุฃูุซุฑ ุชูููุฏุงู:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /users/{userId} {
      allow read, write: if request.auth != null 
        && request.auth.uid == userId
        && request.auth.token.email_verified == true;
    }
    
    match /courses/{courseId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null 
        && get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['admin', 'instructor'];
    }
    
    // ุงููุฒูุฏ ูู ุงูููุงุนุฏ ุงููุชูุฏูุฉ...
  }
}
```

## ุงูููุฒุงุช ุงููุญุณูุฉ ูู ุงููุธุงู ๐

### ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:
- ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุงูุชููุงุฆูุฉ ุนูุฏ ูุดู ุงูุญูุธ
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ููููุฏุฉ
- ุขููุงุช ุงุญุชูุงุทูุฉ ููุญูุธ

### ูุงุฌูุฉ ูุณุชุฎุฏู ูุญุณูุฉ:
- ุฃุฒุฑุงุฑ ูุฅูุดุงุก ุงูููู ุงูุดุฎุตู ูุฏููุงู
- ูุคุดุฑุงุช ุญุงูุฉ ุงูุชุญููู
- ุฑุณุงุฆู ุงูุชุดุฎูุต ูู ูุญุฏุฉ ุงูุชุญูู

### ุงูุชูุงูู ูุน ุงูุฎุทุฉ ุงููุฌุงููุฉ:
- ูุง ูุณุชุฎุฏู Storage (ุบูุฑ ูุชููุฑ ูู ุงูุฎุทุฉ ุงููุฌุงููุฉ)
- ูุนุงูุฌุฉ ุฐููุฉ ูุญุฏูุฏ ุงูุงุณุชุฎุฏุงู
- ุชุญุณูู ุงุณุชุนูุงูุงุช Firestore

---

**ููุงุญุธุฉ ูููุฉ**: ูุฐุง ุงูุฅุตูุงุญ ูุตูู ุฎุตูุตุงู ููุนูู ูุน ุงูุฎุทุฉ ุงููุฌุงููุฉ ูู Firebase ููุง ูุชุทูุจ ุชุฑููุฉ ุงูุญุณุงุจ.